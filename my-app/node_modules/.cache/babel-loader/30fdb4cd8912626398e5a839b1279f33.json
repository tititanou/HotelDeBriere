{"remainingRequest":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\components\\Administrators.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\components\\Administrators.vue","mtime":1598011810840},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGZpcmViYXNlIGZyb20gImZpcmViYXNlIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhZG1pbnM6IFtdLAogICAgICBpc0Nvbm5lY3RlZDogZmFsc2UsCiAgICAgIGlzQWRtaW46IGZhbHNlLAogICAgICBjdXJyZW50VXNlcjogJycsCiAgICAgIGFkbWluU3RhdGU6IGZhbHNlCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuY3VycmVudFVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7CgogICAgaWYgKHRoaXMuY3VycmVudFVzZXIgIT0gbnVsbCkgewogICAgICB0aGlzLmlzQ29ubmVjdGVkID0gdHJ1ZTsKICAgIH0KCiAgICB0aGlzLmxpc3RBbGxVc2VycygpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciB2aWV3VXNlciA9IHRoaXM7CiAgICB2aWV3VXNlci51c2VyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyOwogICAgdmFyIHVzZXJzUmVmID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoInVzZXJzIik7CiAgICB1c2Vyc1JlZi5vbigidmFsdWUiLCBmdW5jdGlvbiAoc25hcHNob3QpIHsKICAgICAgdmFyIGRhdGEgPSBzbmFwc2hvdC52YWwoKTsKICAgICAgdmFyIHVzZXJzID0gW107CiAgICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIGlmIChrZXkgPT0gdmlld1VzZXIuY3VycmVudFVzZXIudWlkKSB7CiAgICAgICAgICB1c2Vycy5wdXNoKHsKICAgICAgICAgICAgZmlyc3RuYW1lOiBkYXRhW2tleV0uZmlyc3RuYW1lLAogICAgICAgICAgICBuYW1lOiBkYXRhW2tleV0ubmFtZSwKICAgICAgICAgICAgYWRtaW46IGRhdGFba2V5XS5hZG1pbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICh1c2Vycy5sZW5ndGggPiAwKSB7CiAgICAgICAgdmlld1VzZXIuY3VycmVudFVzZXIuZmlyc3RuYW1lID0gdXNlcnNbMF0uZmlyc3RuYW1lOwogICAgICAgIHZpZXdVc2VyLmN1cnJlbnRVc2VyLm5hbWUgPSB1c2Vyc1swXS5uYW1lOwogICAgICAgIHZpZXdVc2VyLmN1cnJlbnRVc2VyLmFkbWluID0gdXNlcnNbMF0uYWRtaW47CiAgICAgICAgdmlld1VzZXIuaXNBZG1pbiA9IHZpZXdVc2VyLmN1cnJlbnRVc2VyLmFkbWluOwogICAgICB9CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGxpc3RBbGxVc2VyczogZnVuY3Rpb24gbGlzdEFsbFVzZXJzKCkgewogICAgICB2YXIgdmlld1VzZXIgPSB0aGlzOwogICAgICB2YXIgdXNlcnNSZWYgPSBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZigidXNlcnMiKTsKICAgICAgdXNlcnNSZWYub24oInZhbHVlIiwgZnVuY3Rpb24gKHNuYXBzaG90KSB7CiAgICAgICAgdmFyIGRhdGEgPSBzbmFwc2hvdC52YWwoKTsKICAgICAgICB2YXIgdXNlcnMgPSBbXTsKICAgICAgICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIHVzZXJzLnB1c2goewogICAgICAgICAgICBpZDoga2V5LAogICAgICAgICAgICBmaXJzdG5hbWU6IGRhdGFba2V5XS5maXJzdG5hbWUsCiAgICAgICAgICAgIG5hbWU6IGRhdGFba2V5XS5uYW1lLAogICAgICAgICAgICBhZG1pbjogZGF0YVtrZXldLmFkbWluLAogICAgICAgICAgICBlbWFpbDogZGF0YVtrZXldLmVtYWlsCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICB2aWV3VXNlci5hZG1pbnMgPSB1c2VyczsKICAgICAgfSk7CiAgICB9LAogICAgdXBkYXRlQWRtaW46IGZ1bmN0aW9uIHVwZGF0ZUFkbWluKHVzKSB7CiAgICAgIGNvbnNvbGUubG9nKHVzLmlkKTsKICAgICAgZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ3VzZXJzLycgKyB1cy5pZCkuc2V0KHsKICAgICAgICBmaXJzdG5hbWU6IHVzLmZpcnN0bmFtZSwKICAgICAgICBuYW1lOiB1cy5uYW1lLAogICAgICAgIGVtYWlsOiB1cy5lbWFpbCwKICAgICAgICBhZG1pbjogIXVzLmFkbWluCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh1cy5hZG1pbiA9PSBmYWxzZSkgewogICAgICAgICAgYWxlcnQoIkwndXRpbGlzYXRldXIgIiArIHVzLmZpcnN0bmFtZSArICIgIiArIHVzLm5hbWUgKyAiIGEgbWFpbnRlbmFudCBsZSBzdGF0dXQgQWRtaW5pc3RyYXRldXIuIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFsZXJ0KCJMJ3V0aWxpc2F0ZXVyICIgKyB1cy5maXJzdG5hbWUgKyAiICIgKyB1cy5uYW1lICsgIiBuZSBmYWl0IHBsdXMgcGFydGllIGRlcyBhZG1pbmlzdHJhdGV1cnMuIik7CiAgICAgICAgfSAvL2FsZXJ0KCJMZSBzdGF0dXQgZGUgbCd1dGlsaXNhdGV1ciAiICsgdXMuZmlyc3RuYW1lICsgIiAiICsgdXMubmFtZSArICJhIGJpZW4gw6l0w6kgbW9kaWZpw6kuIikKCiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["Administrators.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n     <b-card title=\"Liste des administrateurs\" style=\"max-width: 45rem; min-width: 45rem; float:none;\" class=\"mb-4 center-block\" v-if=\"isConnected && isAdmin\">\r\n        <b-list-group>\r\n            <b-list-item v-for=\"admin in admins\" :key=\"admin.id\">\r\n                <b-form-checkbox label=\"Administrateur\" v-model=\"admin.admin\" @change=\"updateAdmin(admin)\" name=\"check-button\" switch></b-form-checkbox>{{admin.firstname}} {{admin.name}}\r\n            </b-list-item>\r\n        </b-list-group>\r\n    </b-card>\r\n     <b-card title=\"Liste des administrateurs\" class=\"mb-4 \" v-else-if=\"isConnected && !isAdmin\">\r\n            <p>Accès refusé! Vous devez être administrateur pour accéder au contenu de cette page.</p>\r\n            <b-button variant=\"primary\" href=\"/\">Retour à l'acceuil</b-button>\r\n        </b-card>\r\n        <b-card title=\"Liste des administrateurs\" class=\"mb-4 \" v-else>\r\n            <p>Accès refusé! Vous devez vous connecter.</p>\r\n            <b-button variant=\"primary\" href=\"/\">Retour à l'acceuil</b-button>\r\n            <b-button variant=\"primary\" href=\"inscriptionConnexion\">Se connecter</b-button>\r\n        </b-card>\r\n</template> \r\n<script>\r\nimport firebase from \"firebase\";\r\nexport default {\r\n    data(){\r\n        return{\r\n            admins:[],\r\n            isConnected: false,\r\n            isAdmin: false,\r\n            currentUser:'',\r\n            adminState: false,\r\n        }\r\n    },\r\n    created(){\r\n        this.currentUser = firebase.auth().currentUser;\r\n        if (this.currentUser != null){\r\n            this.isConnected = true;     \r\n        }\r\n        this.listAllUsers();\r\n    },\r\n    mounted(){\r\n        let viewUser = this;\r\n        viewUser.user = firebase.auth().currentUser;\r\n        const usersRef = firebase.database().ref(\"users\");\r\n        usersRef.on(\"value\", snapshot => {\r\n            let data = snapshot.val();\r\n            let users = [];\r\n            Object.keys(data).forEach(key =>{\r\n                if (key == viewUser.currentUser.uid){\r\n                    users.push({\r\n                        firstname: data[key].firstname,\r\n                        name: data[key].name,\r\n                        admin: data[key].admin\r\n                    });\r\n                }\r\n            });\r\n            if(users.length > 0) {\r\n                viewUser.currentUser.firstname = users[0].firstname;\r\n                viewUser.currentUser.name = users[0].name;\r\n                viewUser.currentUser.admin = users[0].admin;\r\n                viewUser.isAdmin = viewUser.currentUser.admin;\r\n            }\r\n        });\r\n    },\r\n    methods:{\r\n        listAllUsers(){\r\n            let viewUser = this;\r\n            const usersRef = firebase.database().ref(\"users\");\r\n            usersRef.on(\"value\", snapshot => {\r\n                let data = snapshot.val();\r\n                let users = [];\r\n                Object.keys(data).forEach(key =>{\r\n                    users.push({\r\n                        id: key,\r\n                        firstname: data[key].firstname,\r\n                        name: data[key].name,\r\n                        admin: data[key].admin,\r\n                        email: data[key].email\r\n                    });\r\n                });\r\n                viewUser.admins = users;\r\n            });\r\n        },\r\n        updateAdmin(us){\r\n            console.log(us.id)\r\n            firebase.database().ref('users/' + us.id).set({\r\n                firstname: us.firstname,\r\n                name: us.name,\r\n                email: us.email,\r\n                admin: !us.admin\r\n            }).then(() => {\r\n                if(us.admin == false){\r\n                    alert(\"L'utilisateur \" + us.firstname + \" \" + us.name + \" a maintenant le statut Administrateur.\")\r\n                }\r\n                else{\r\n                    alert(\"L'utilisateur \" + us.firstname + \" \" + us.name + \" ne fait plus partie des administrateurs.\")\r\n                }\r\n                //alert(\"Le statut de l'utilisateur \" + us.firstname + \" \" + us.name + \"a bien été modifié.\")\r\n            });\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n"],"sourceRoot":"src/components"}]}