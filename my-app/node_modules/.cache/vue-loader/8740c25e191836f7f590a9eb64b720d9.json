{"remainingRequest":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\components\\Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\components\\Profile.vue","mtime":1598013263712},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovL21wb3J0IGF4aW9zIGZyb20gImF4aW9zIg0KaW1wb3J0IGZpcmViYXNlIGZyb20gImZpcmViYXNlIg0KaW1wb3J0ICJmaXJlYmFzZS9hdXRoIg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIGRhdGEoKXsNCiAgICAgICAgcmV0dXJuew0KICAgICAgICAgICAgY29ubmVjdGVkOiBmYWxzZSwNCiAgICAgICAgICAgIHVzZXI6IHt9LA0KICAgICAgICAgICAgdXNlcnNsY3Q6IHsNCiAgICAgICAgICAgICAgICBmaXJzdG5hbWU6JycsDQogICAgICAgICAgICAgICAgbmFtZTogJycsDQogICAgICAgICAgICAgICAgYWRtaW46IGZhbHNlDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaXNBZG1pbjogZmFsc2UsDQogICAgICAgICAgICBmb3JtOnsNCiAgICAgICAgICAgICAgICBmaXJzdG5hbWU6JycsDQogICAgICAgICAgICAgICAgbmFtZTonJywNCiAgICAgICAgICAgICAgICBlbWFpbDogJycNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCiAgICB9LA0KICAgIGNyZWF0ZWQoKXsNCiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLnVzZXIubG9nZ2VkSW47DQogICAgICAgIGNvbnNvbGUubG9nKGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlci5lbWFpbCkNCiAgICAgICAgdGhpcy51c2VyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyOw0KICAgICAgICB0aGlzLmZvcm0uZW1haWwgPSB0aGlzLnVzZXIuZW1haWw7DQogICAgfSwNCiAgICBtZXRob2RzOnsNCiAgICAgICAgY3JlYXRlVXNlcigpew0KICAgICAgICAgICAgbGV0IHVzZXJmYiA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjsNCiAgICAgICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCd1c2Vycy8nICsgdXNlcmZiLnVpZCkuc2V0KHsNCiAgICAgICAgICAgICAgICBmaXJzdG5hbWU6IHRoaXMuZm9ybS5maXJzdG5hbWUsDQogICAgICAgICAgICAgICAgbmFtZTogdGhpcy5mb3JtLm5hbWUsDQogICAgICAgICAgICAgICAgZW1haWw6IHVzZXJmYi5lbWFpbCwNCiAgICAgICAgICAgICAgICBhZG1pbjogdGhpcy51c2Vyc2xjdC5hZG1pbg0KICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgYWxlcnQoIlZvdHJlIHByb2ZpbCBhIMOpdMOpIG1pcyDDoCBqb3VyLiIpDQogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoeyBuYW1lOiAiaG9tZSIgfSkNCg0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgfSwNCiAgICBtb3VudGVkKCkgew0KICAgICAgICBsZXQgdmlld1VzZXIgPSB0aGlzOw0KICAgICAgICBjb25zdCB1c2Vyc1JlZiA9IGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCJ1c2VycyIpOw0KICAgICAgICB1c2Vyc1JlZi5vbigidmFsdWUiLCBzbmFwc2hvdCA9PiB7DQogICAgICAgICAgICBsZXQgZGF0YSA9IHNuYXBzaG90LnZhbCgpOw0KICAgICAgICAgICAgbGV0IHVzZXJzID0gW107DQogICAgICAgICAgICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKGtleSA9PnsNCiAgICAgICAgICAgICAgICBpZiAoa2V5ID09IHZpZXdVc2VyLnVzZXIudWlkKXsNCiAgICAgICAgICAgICAgICAgICAgdXNlcnMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdG5hbWU6IGRhdGFba2V5XS5maXJzdG5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBkYXRhW2tleV0ubmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFkbWluOiBkYXRhW2tleV0uYWRtaW4NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBpZih1c2Vycy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgdmlld1VzZXIudXNlcnNsY3QuZmlyc3RuYW1lID0gdXNlcnNbMF0uZmlyc3RuYW1lOw0KICAgICAgICAgICAgICAgIHZpZXdVc2VyLnVzZXJzbGN0Lm5hbWUgPSB1c2Vyc1swXS5uYW1lOw0KICAgICAgICAgICAgICAgIHZpZXdVc2VyLnVzZXJzbGN0LmFkbWluID0gdXNlcnNbMF0uYWRtaW47DQogICAgICAgICAgICAgICAgdmlld1VzZXIuZm9ybS5maXJzdG5hbWUgPSB2aWV3VXNlci51c2Vyc2xjdC5maXJzdG5hbWU7DQogICAgICAgICAgICAgICAgdmlld1VzZXIuZm9ybS5uYW1lID0gdmlld1VzZXIudXNlcnNsY3QubmFtZTsNCiAgICAgICAgICAgICAgICB2aWV3VXNlci5pc0FkbWluID0gdmlld1VzZXIudXNlcnNsY3QuYWRtaW47DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0sDQp9DQo="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <b-card title=\"Mon profil\" style=\"max-width: 45rem; min-width: 45rem; float:none;\" class=\"mb-4 center-block\">\r\n        <b-form @submit.prevent=\"createUser\">\r\n            <b-form-group label=\"Prénom:\" label-for=\"inputFirstname\">\r\n                <b-form-input id=\"inputFirstName\" v-model=\"form.firstname\" type=\"text\" required placeholder=\"Prénom\">{{userslct.firstname}}</b-form-input>\r\n            </b-form-group>\r\n            <b-form-group label=\"Nom\" label-for=\"inputName\">\r\n                <b-form-input id=\"inputName\" v-model=\"form.name\" type=\"text\" required placeholder=\"Nom\">{{userslct.name}}</b-form-input>\r\n            </b-form-group>\r\n            <b-form-group label=\"Email\" label-for=\"inputEmail\">\r\n                <b-form-input id=\"inputEmail\" v-model=\"form.email\" type=\"email\" disabled>{{user.email}}</b-form-input>\r\n            </b-form-group>\r\n            <div class=\"row\">\r\n                <b-button class=\"mx-3 col-2\" type=\"submit\" variant=\"primary\">Valider</b-button>\r\n                <div class=\"col-5\"></div>\r\n                <b-button right class=\"mx-2 col-4\" v-if=\"isAdmin\" variant=\"danger\" href=\"admin\">Espace Administrateur</b-button>\r\n            </div>\r\n            \r\n        </b-form>\r\n        \r\n    </b-card>\r\n</template>\r\n\r\n<script>\r\n//mport axios from \"axios\"\r\nimport firebase from \"firebase\"\r\nimport \"firebase/auth\"\r\nexport default {\r\n    data(){\r\n        return{\r\n            connected: false,\r\n            user: {},\r\n            userslct: {\r\n                firstname:'',\r\n                name: '',\r\n                admin: false\r\n            },\r\n            isAdmin: false,\r\n            form:{\r\n                firstname:'',\r\n                name:'',\r\n                email: ''\r\n            },\r\n        }\r\n    },\r\n    created(){\r\n        this.connected = this.$store.getters.user.loggedIn;\r\n        console.log(firebase.auth().currentUser.email)\r\n        this.user = firebase.auth().currentUser;\r\n        this.form.email = this.user.email;\r\n    },\r\n    methods:{\r\n        createUser(){\r\n            let userfb = firebase.auth().currentUser;\r\n            firebase.database().ref('users/' + userfb.uid).set({\r\n                firstname: this.form.firstname,\r\n                name: this.form.name,\r\n                email: userfb.email,\r\n                admin: this.userslct.admin\r\n            }).then(() => {\r\n                alert(\"Votre profil a été mis à jour.\")\r\n                this.$router.replace({ name: \"home\" })\r\n\r\n            });\r\n        },\r\n    },\r\n    mounted() {\r\n        let viewUser = this;\r\n        const usersRef = firebase.database().ref(\"users\");\r\n        usersRef.on(\"value\", snapshot => {\r\n            let data = snapshot.val();\r\n            let users = [];\r\n            Object.keys(data).forEach(key =>{\r\n                if (key == viewUser.user.uid){\r\n                    users.push({\r\n                        firstname: data[key].firstname,\r\n                        name: data[key].name,\r\n                        admin: data[key].admin\r\n                    });\r\n                }\r\n            });\r\n            if(users.length > 0) {\r\n                viewUser.userslct.firstname = users[0].firstname;\r\n                viewUser.userslct.name = users[0].name;\r\n                viewUser.userslct.admin = users[0].admin;\r\n                viewUser.form.firstname = viewUser.userslct.firstname;\r\n                viewUser.form.name = viewUser.userslct.name;\r\n                viewUser.isAdmin = viewUser.userslct.admin;\r\n            }\r\n        });\r\n    },\r\n}\r\n</script>"]}]}