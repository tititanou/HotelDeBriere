{"remainingRequest":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\components\\Administrators.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\components\\Administrators.vue","mtime":1598011810840},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZmlyZWJhc2UgZnJvbSAiZmlyZWJhc2UiOw0KZXhwb3J0IGRlZmF1bHQgew0KICAgIGRhdGEoKXsNCiAgICAgICAgcmV0dXJuew0KICAgICAgICAgICAgYWRtaW5zOltdLA0KICAgICAgICAgICAgaXNDb25uZWN0ZWQ6IGZhbHNlLA0KICAgICAgICAgICAgaXNBZG1pbjogZmFsc2UsDQogICAgICAgICAgICBjdXJyZW50VXNlcjonJywNCiAgICAgICAgICAgIGFkbWluU3RhdGU6IGZhbHNlLA0KICAgICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVkKCl7DQogICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7DQogICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyICE9IG51bGwpew0KICAgICAgICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IHRydWU7ICAgICANCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmxpc3RBbGxVc2VycygpOw0KICAgIH0sDQogICAgbW91bnRlZCgpew0KICAgICAgICBsZXQgdmlld1VzZXIgPSB0aGlzOw0KICAgICAgICB2aWV3VXNlci51c2VyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyOw0KICAgICAgICBjb25zdCB1c2Vyc1JlZiA9IGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCJ1c2VycyIpOw0KICAgICAgICB1c2Vyc1JlZi5vbigidmFsdWUiLCBzbmFwc2hvdCA9PiB7DQogICAgICAgICAgICBsZXQgZGF0YSA9IHNuYXBzaG90LnZhbCgpOw0KICAgICAgICAgICAgbGV0IHVzZXJzID0gW107DQogICAgICAgICAgICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKGtleSA9PnsNCiAgICAgICAgICAgICAgICBpZiAoa2V5ID09IHZpZXdVc2VyLmN1cnJlbnRVc2VyLnVpZCl7DQogICAgICAgICAgICAgICAgICAgIHVzZXJzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RuYW1lOiBkYXRhW2tleV0uZmlyc3RuYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZGF0YVtrZXldLm5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICBhZG1pbjogZGF0YVtrZXldLmFkbWluDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgaWYodXNlcnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHZpZXdVc2VyLmN1cnJlbnRVc2VyLmZpcnN0bmFtZSA9IHVzZXJzWzBdLmZpcnN0bmFtZTsNCiAgICAgICAgICAgICAgICB2aWV3VXNlci5jdXJyZW50VXNlci5uYW1lID0gdXNlcnNbMF0ubmFtZTsNCiAgICAgICAgICAgICAgICB2aWV3VXNlci5jdXJyZW50VXNlci5hZG1pbiA9IHVzZXJzWzBdLmFkbWluOw0KICAgICAgICAgICAgICAgIHZpZXdVc2VyLmlzQWRtaW4gPSB2aWV3VXNlci5jdXJyZW50VXNlci5hZG1pbjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBtZXRob2RzOnsNCiAgICAgICAgbGlzdEFsbFVzZXJzKCl7DQogICAgICAgICAgICBsZXQgdmlld1VzZXIgPSB0aGlzOw0KICAgICAgICAgICAgY29uc3QgdXNlcnNSZWYgPSBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZigidXNlcnMiKTsNCiAgICAgICAgICAgIHVzZXJzUmVmLm9uKCJ2YWx1ZSIsIHNuYXBzaG90ID0+IHsNCiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHNuYXBzaG90LnZhbCgpOw0KICAgICAgICAgICAgICAgIGxldCB1c2VycyA9IFtdOw0KICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goa2V5ID0+ew0KICAgICAgICAgICAgICAgICAgICB1c2Vycy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBrZXksDQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdG5hbWU6IGRhdGFba2V5XS5maXJzdG5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBkYXRhW2tleV0ubmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFkbWluOiBkYXRhW2tleV0uYWRtaW4sDQogICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogZGF0YVtrZXldLmVtYWlsDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHZpZXdVc2VyLmFkbWlucyA9IHVzZXJzOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgICAgIHVwZGF0ZUFkbWluKHVzKXsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzLmlkKQ0KICAgICAgICAgICAgZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ3VzZXJzLycgKyB1cy5pZCkuc2V0KHsNCiAgICAgICAgICAgICAgICBmaXJzdG5hbWU6IHVzLmZpcnN0bmFtZSwNCiAgICAgICAgICAgICAgICBuYW1lOiB1cy5uYW1lLA0KICAgICAgICAgICAgICAgIGVtYWlsOiB1cy5lbWFpbCwNCiAgICAgICAgICAgICAgICBhZG1pbjogIXVzLmFkbWluDQogICAgICAgICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICBpZih1cy5hZG1pbiA9PSBmYWxzZSl7DQogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJMJ3V0aWxpc2F0ZXVyICIgKyB1cy5maXJzdG5hbWUgKyAiICIgKyB1cy5uYW1lICsgIiBhIG1haW50ZW5hbnQgbGUgc3RhdHV0IEFkbWluaXN0cmF0ZXVyLiIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJMJ3V0aWxpc2F0ZXVyICIgKyB1cy5maXJzdG5hbWUgKyAiICIgKyB1cy5uYW1lICsgIiBuZSBmYWl0IHBsdXMgcGFydGllIGRlcyBhZG1pbmlzdHJhdGV1cnMuIikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy9hbGVydCgiTGUgc3RhdHV0IGRlIGwndXRpbGlzYXRldXIgIiArIHVzLmZpcnN0bmFtZSArICIgIiArIHVzLm5hbWUgKyAiYSBiaWVuIMOpdMOpIG1vZGlmacOpLiIpDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KfQ0K"},{"version":3,"sources":["Administrators.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Administrators.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n     <b-card title=\"Liste des administrateurs\" style=\"max-width: 45rem; min-width: 45rem; float:none;\" class=\"mb-4 center-block\" v-if=\"isConnected && isAdmin\">\r\n        <b-list-group>\r\n            <b-list-item v-for=\"admin in admins\" :key=\"admin.id\">\r\n                <b-form-checkbox label=\"Administrateur\" v-model=\"admin.admin\" @change=\"updateAdmin(admin)\" name=\"check-button\" switch></b-form-checkbox>{{admin.firstname}} {{admin.name}}\r\n            </b-list-item>\r\n        </b-list-group>\r\n    </b-card>\r\n     <b-card title=\"Liste des administrateurs\" class=\"mb-4 \" v-else-if=\"isConnected && !isAdmin\">\r\n            <p>Accès refusé! Vous devez être administrateur pour accéder au contenu de cette page.</p>\r\n            <b-button variant=\"primary\" href=\"/\">Retour à l'acceuil</b-button>\r\n        </b-card>\r\n        <b-card title=\"Liste des administrateurs\" class=\"mb-4 \" v-else>\r\n            <p>Accès refusé! Vous devez vous connecter.</p>\r\n            <b-button variant=\"primary\" href=\"/\">Retour à l'acceuil</b-button>\r\n            <b-button variant=\"primary\" href=\"inscriptionConnexion\">Se connecter</b-button>\r\n        </b-card>\r\n</template> \r\n<script>\r\nimport firebase from \"firebase\";\r\nexport default {\r\n    data(){\r\n        return{\r\n            admins:[],\r\n            isConnected: false,\r\n            isAdmin: false,\r\n            currentUser:'',\r\n            adminState: false,\r\n        }\r\n    },\r\n    created(){\r\n        this.currentUser = firebase.auth().currentUser;\r\n        if (this.currentUser != null){\r\n            this.isConnected = true;     \r\n        }\r\n        this.listAllUsers();\r\n    },\r\n    mounted(){\r\n        let viewUser = this;\r\n        viewUser.user = firebase.auth().currentUser;\r\n        const usersRef = firebase.database().ref(\"users\");\r\n        usersRef.on(\"value\", snapshot => {\r\n            let data = snapshot.val();\r\n            let users = [];\r\n            Object.keys(data).forEach(key =>{\r\n                if (key == viewUser.currentUser.uid){\r\n                    users.push({\r\n                        firstname: data[key].firstname,\r\n                        name: data[key].name,\r\n                        admin: data[key].admin\r\n                    });\r\n                }\r\n            });\r\n            if(users.length > 0) {\r\n                viewUser.currentUser.firstname = users[0].firstname;\r\n                viewUser.currentUser.name = users[0].name;\r\n                viewUser.currentUser.admin = users[0].admin;\r\n                viewUser.isAdmin = viewUser.currentUser.admin;\r\n            }\r\n        });\r\n    },\r\n    methods:{\r\n        listAllUsers(){\r\n            let viewUser = this;\r\n            const usersRef = firebase.database().ref(\"users\");\r\n            usersRef.on(\"value\", snapshot => {\r\n                let data = snapshot.val();\r\n                let users = [];\r\n                Object.keys(data).forEach(key =>{\r\n                    users.push({\r\n                        id: key,\r\n                        firstname: data[key].firstname,\r\n                        name: data[key].name,\r\n                        admin: data[key].admin,\r\n                        email: data[key].email\r\n                    });\r\n                });\r\n                viewUser.admins = users;\r\n            });\r\n        },\r\n        updateAdmin(us){\r\n            console.log(us.id)\r\n            firebase.database().ref('users/' + us.id).set({\r\n                firstname: us.firstname,\r\n                name: us.name,\r\n                email: us.email,\r\n                admin: !us.admin\r\n            }).then(() => {\r\n                if(us.admin == false){\r\n                    alert(\"L'utilisateur \" + us.firstname + \" \" + us.name + \" a maintenant le statut Administrateur.\")\r\n                }\r\n                else{\r\n                    alert(\"L'utilisateur \" + us.firstname + \" \" + us.name + \" ne fait plus partie des administrateurs.\")\r\n                }\r\n                //alert(\"Le statut de l'utilisateur \" + us.firstname + \" \" + us.name + \"a bien été modifié.\")\r\n            });\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n"]}]}