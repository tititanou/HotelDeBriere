{"remainingRequest":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\views\\EditArticle.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\src\\views\\EditArticle.vue","mtime":1598003420789},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\r_kev\\Documents\\SiteWebStage\\HotelDeBriere\\my-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZmlyZWJhc2UgZnJvbSAiZmlyZWJhc2UiOw0KaW1wb3J0IEVkaXQgZnJvbSAiQC9jb21wb25lbnRzL2VkaXRBcnRpY2xlLnZ1ZSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgIEVkaXQsDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGFydGljbGVzTGlzdDogW10sDQogICAgICBpc0Nvbm5lY3RlZDogZmFsc2UsDQogICAgICBpc0FkbWluOiBmYWxzZSwNCiAgICAgIHVzZXI6ICcnLA0KICAgICAgY3VycmVudFU6ew0KICAgICAgICBmaXJzdG5hbWU6JycsDQogICAgICAgIG5hbWU6JycsDQogICAgICAgIGFkbWluOmZhbHNlDQogICAgICB9DQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmFydGljbGVzTGlzdCA9IHRoaXMuZGlzcGxheSgpOw0KICAgIGNvbnNvbGUubG9nKCJsZSBwYiBlc3QgaWNpISIpOw0KICAgIGNvbnNvbGUubG9nKCIxOiAiICsgdGhpcy5hcnRpY2xlc0xpc3QubGVuZ3RoKTsNCiAgICB0aGlzLnVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7DQogICAgaWYgKHRoaXMudXNlciAhPSBudWxsKXsNCiAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSB0cnVlOw0KICAgIH0NCiAgfSwNCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgew0KICAgIGxldCB2aWV3VXNlciA9IHRoaXM7DQogICAgICAgIHZpZXdVc2VyLnVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7DQogICAgICAgIGNvbnN0IHVzZXJzUmVmID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoInVzZXJzIik7DQogICAgICAgIHVzZXJzUmVmLm9uKCJ2YWx1ZSIsIHNuYXBzaG90ID0+IHsNCiAgICAgICAgICAgIGxldCBkYXRhID0gc25hcHNob3QudmFsKCk7DQogICAgICAgICAgICBsZXQgdXNlcnMgPSBbXTsNCiAgICAgICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goa2V5ID0+ew0KICAgICAgICAgICAgICAgIGlmIChrZXkgPT0gdmlld1VzZXIudXNlci51aWQpew0KICAgICAgICAgICAgICAgICAgICB1c2Vycy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0bmFtZTogZGF0YVtrZXldLmZpcnN0bmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGRhdGFba2V5XS5uYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgYWRtaW46IGRhdGFba2V5XS5hZG1pbg0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGlmKHVzZXJzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICB2aWV3VXNlci5jdXJyZW50VS5maXJzdG5hbWUgPSB1c2Vyc1swXS5maXJzdG5hbWU7DQogICAgICAgICAgICAgICAgdmlld1VzZXIuY3VycmVudFUubmFtZSA9IHVzZXJzWzBdLm5hbWU7DQogICAgICAgICAgICAgICAgdmlld1VzZXIuY3VycmVudFUuYWRtaW4gPSB1c2Vyc1swXS5hZG1pbjsNCiAgICAgICAgICAgICAgICB2aWV3VXNlci5pc0FkbWluID0gdmlld1VzZXIuY3VycmVudFUuYWRtaW47DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZGlzcGxheSgpIHsNCiAgICAgIHZhciBsaXN0ID0gW107DQogICAgICBsZXQgcmVmID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoImFydGljbGVzIik7DQogICAgICByZWYub25jZSgidmFsdWUiLCBmdW5jdGlvbiAoc25hcHNob3QpIHsNCiAgICAgICAgc25hcHNob3QuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRTbmFwc2hvdCkgew0KICAgICAgICAgIHZhciBjaGlsZEtleSA9IGNoaWxkU25hcHNob3Qua2V5Ow0KICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBjaGlsZFNuYXBzaG90LnZhbCgpOw0KICAgICAgICAgIGNvbnN0IGFydGljbGUgPSB7DQogICAgICAgICAgICBpZDogY2hpbGRLZXksDQogICAgICAgICAgICB0aXRsZTogY2hpbGREYXRhLnRpdGxlLA0KICAgICAgICAgICAgcmVsZWFzZURhdGU6IGNoaWxkRGF0YS5yZWxlYXNlRGF0ZSwNCiAgICAgICAgICB9Ow0KICAgICAgICAgIGNvbnNvbGUubG9nKGFydGljbGUpOw0KICAgICAgICAgIGxpc3QucHVzaChhcnRpY2xlKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICAgIGNvbnNvbGUubG9nKGxpc3QubGVuZ3RoKTsNCiAgICAgIHJldHVybiBsaXN0Ow0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["EditArticle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditArticle.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-container>\r\n    <div class=\"row my-5\">\r\n      <h1>Articles:</h1>\r\n    </div>\r\n    <div v-if=\"isConnected && isAdmin\">\r\n      <Edit\r\n        v-for=\"articleI in articlesList\"\r\n        :article=\"articleI\"\r\n        :key=\"articleI.id\"\r\n        :articlesList=\"articlesList\"\r\n      />\r\n    </div>\r\n    <b-card class=\"mb-4 \" v-else-if=\"isConnected && !isAdmin\">\r\n      <p>Accès refusé! Vous devez être administrateur pour accéder au contenu de cette page.</p>\r\n      <b-button variant=\"primary\" href=\"/\">Retour à l'acceuil</b-button>\r\n    </b-card>\r\n    <b-card class=\"mb-4 \" v-else>\r\n      <p>Accès refusé! Vous devez vous connecter.</p>\r\n      <b-button variant=\"primary\" href=\"/\">Retour à l'acceuil</b-button>\r\n      <b-button variant=\"primary\" href=\"inscriptionConnexion\">Se connecter</b-button>\r\n    </b-card>\r\n  </b-container>\r\n</template>\r\n\r\n\r\n<script>\r\nimport firebase from \"firebase\";\r\nimport Edit from \"@/components/editArticle.vue\";\r\n\r\nexport default {\r\n  components: {\r\n    Edit,\r\n  },\r\n  data() {\r\n    return {\r\n      articlesList: [],\r\n      isConnected: false,\r\n      isAdmin: false,\r\n      user: '',\r\n      currentU:{\r\n        firstname:'',\r\n        name:'',\r\n        admin:false\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    this.articlesList = this.display();\r\n    console.log(\"le pb est ici!\");\r\n    console.log(\"1: \" + this.articlesList.length);\r\n    this.user = firebase.auth().currentUser;\r\n    if (this.user != null){\r\n      this.isConnected = true;\r\n    }\r\n  },\r\n  mounted: function () {\r\n    let viewUser = this;\r\n        viewUser.user = firebase.auth().currentUser;\r\n        const usersRef = firebase.database().ref(\"users\");\r\n        usersRef.on(\"value\", snapshot => {\r\n            let data = snapshot.val();\r\n            let users = [];\r\n            Object.keys(data).forEach(key =>{\r\n                if (key == viewUser.user.uid){\r\n                    users.push({\r\n                        firstname: data[key].firstname,\r\n                        name: data[key].name,\r\n                        admin: data[key].admin\r\n                    });\r\n                }\r\n            });\r\n            if(users.length > 0) {\r\n                viewUser.currentU.firstname = users[0].firstname;\r\n                viewUser.currentU.name = users[0].name;\r\n                viewUser.currentU.admin = users[0].admin;\r\n                viewUser.isAdmin = viewUser.currentU.admin;\r\n            }\r\n        });\r\n  },\r\n  methods: {\r\n    display() {\r\n      var list = [];\r\n      let ref = firebase.database().ref(\"articles\");\r\n      ref.once(\"value\", function (snapshot) {\r\n        snapshot.forEach(function (childSnapshot) {\r\n          var childKey = childSnapshot.key;\r\n          var childData = childSnapshot.val();\r\n          const article = {\r\n            id: childKey,\r\n            title: childData.title,\r\n            releaseDate: childData.releaseDate,\r\n          };\r\n          console.log(article);\r\n          list.push(article);\r\n        });\r\n      });\r\n      console.log(list.length);\r\n      return list;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style> "]}]}